grammar Codiphi
  rule codex
    space?
    declaration_list?
    space?
    list?
    space?
  end
  
  rule list
    "list" space string space permission_block
  end
  
  rule permission_block
    "{" space permission+ space "}"
  end
  
  rule permission
    "demands" space integer space name space role_token
  end
  
  rule integer
    [0-9]
  end
  
  rule role_token
    "model"
    / "unit"
  end
  
  rule declaration
    cost_measure
    / model
  end

  rule declaration_list
    declaration (space declaration)*
  end
  
  rule model
    'model' space name (space attribute_block)?
  end

  rule attribute_block
    "{" space attribute+ space "}"
  end

  rule attribute
    [a-zA-Z0-9_]+ '' space [a-zA-Z0-9_]+ ''
  end
  
  rule comment
    '#' (!eoc .)* eoc
  end
  
  rule name
    ':' [a-zA-Z0-9_]+ 
  end
  
  rule string
    '"' ( !'"' . )* '"'
  end
  
  rule cost_measure
    'cost_measure' space string
  end
  
  rule eoc
    [\n] / eof
  end
    
  rule eof
    !.
  end
  
  rule space
    ([ \t\n] / comment)+
  end
  
end