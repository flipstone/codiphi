#!/usr/bin/env ruby
require_relative '../lib/codiphi.rb'
require_relative './codiphi_run'

#
# Arguments
#
if ARGV.length != 2
  puts "Usage: codiphi <command> <list_json>"
  exit(1)
end

command, list_json = *ARGV

#
# load list_json
#
data = {}
say "loading json file at #{list_json}" do
  data = read_json(list_json)
end

case command.to_sym
when :transform
  transform(data)
when :emit
  puts emit(data)
end

