#!/usr/bin/env ruby
require_relative '../lib/codiphi.rb'

#
# Arguments
#
if ARGV.length != 2
  puts "Usage: codiphi <command> <list_json>"
  exit(1)
end

command, list_json = *ARGV

#
# load list_json
#
data = {}
say "loading json file at #{list_json}" do
  data = Codiphi::Support.read_json(list_json)
end

engine = Codiphi::Engine.new(data)

case command.to_sym
when :transform
  engine.transform
when :emit
  puts engine.emit
when :cost
  puts engine.cost
end

